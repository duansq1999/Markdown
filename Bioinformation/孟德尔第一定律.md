## 孟德尔遗传定律简介

现代的遗传定律首先由**Mendel**在1865年提出。在此之前的遗传模型为**混合遗传**，也就是后代性状必须表现为其父母性状的混合。这个模型显然违反了人们的常识（比如两个较矮的父母会可能会生出比他们更高的后代）和统计学（随着时间的推移，混合特征会渐渐地融入平均）。

Mendel研究了大量的豌豆，认为不应将性状视为连续过程，而应将其划分为称为**因子**的离散构建块。此外，他提出每个因子都有不同的形式，称为**等位基因**。

**Mendel第一定律**（也称为分离定律）描述每个生物体都拥有一对特定因子的等位基因。如果个体的两个等位基因对于给定因子是**相同的**，则该因子是**纯合的**（homozygous）;如果等位基因**不同**，那么个体是**杂合的**（heterozygous）。第一定律得出结论：对于任何因子，生物体将会随机地将其两个等位基因中的一个传递给每个后代，以便后代从每个母体接收一个等位基因。

Mendel还认为，任何因子只对应于两个可能的等位基因，**显性**（dominant）和**隐性**（recessive）等位基因。生物体仅需要拥有一个显性等位基因就可以显示由显性等位基因代表的性状。换句话说，生物体能够显示由隐性等位基因编码的性状的唯一方式是个体是该因子的纯合隐性。

我们可以用大写字母（例如A）编码因子的显性等位基因，用小写字母（例如a）编码隐性等位基因。因为杂合生物可以具有隐性等位基因而不显示性状的隐性形式，所以我们今后将生物体的**基因型**（genotype）定义为其精确的基因组成，并将其**表现型**（phenotype）定义为生物体可观察特征的完整集合。

描述后代从父母那里继承两个等位基因的不同可能性可以用**旁氏表**表示；有关示例，请参见图1。

**图1.**一个旁氏表，表示杂合生物（Yy）与纯合隐性生物（yy）杂交的可能结果；这里，显性等位基因Y对应于黄豌豆荚，而隐性等位基因y对应于绿豌豆荚。

## 问题

**概率**（probability）是研究随机发生现象的数学方法。我们将使用**随机变量**对这种现象进行建模，随机变量只是一个变量，它可以根据随机过程的结果取得许多不同的值。

例如，假设我们有一个装有3个红球和2个蓝球的包。如果我们让X代表对应于球颜色的随机变量，则两个结果中每一个的**概率**分别是Pr(X=red)=3/5和Pr(X=blue)=2/5。

随机变量可以组合以产生新的随机变量。回到球的例子，让Y代表从袋子中抽出的第二个球的颜色（第一个球不放回）。则Y的概率取决于我们取的第一颗球是红色还是蓝色。为了表示随机变量X和Y产生的所有结果，我们可以使用**概率树图**。如图2所示，该分支图表示X和Y的所有可能的概率，其结果在树的端点（叶子）处。任何结果的概率都是从树的开始沿路径的概率乘积给出的。

**图2.** 概率树图中任何结果（叶）的概率由从树的开始到结果的概率的乘积给出。例如，X为蓝色且Y为蓝色的概率等于(2/5)×(1/4)=1/10。

**事件**（event）为结果的集合。由于结果是截然不同的，因此事件的概率可以写成其组成结果概率的总和。对于我们上面的例子，记事件A为"Y为蓝色"，则事件A的概率为： 
$$
Pr(X=blue\ and\ Y=blue)+Pr(X=red\ and\ Y=blue)
$$

即(3/10)+(1/10)=2/5（见上图2）。

**Given:** 三个正整数*k*，*m*和*n*，其中*k*代表显性纯合子个体数，*m*代表杂合子个体数，*n*代表隐性纯合子个体数。

**Return:** 随机选择两个个体交配将产生具有显性等位基因的个体的概率（假设任何两种生物都可以交配）。

### 样本输入

```
2 2 2
```

###　样本输出

```
0.78333
```

## 算法分析

根据已知我们可以假设我们有*k*个AA型个体，*m*个Aa型个体和*n*个aa型个体，我们可以分析出以下三种情形：

1. 当一个亲本为AA型时，无论选择的另外一个亲本是什么型，其后代都为具有显性等位基因；

2. 当一个亲本为Aa型时：

   a. 若另外一个亲本为Aa型时，后代具有显性等位基因的概率为3/4=0.75；

   b. 若另外一个亲本为aa型时，后代具有显性等位基因的概率为2/4=0.5；

3. 当两个亲本均为aa型时，后代具有显性等位基因的概率为0。

因此我们可以得到下面这个式子：
$$
\begin{align*}
Pr(AA\or Aa) &= \frac{k\cdot (k-1)+k\cdot m+k\cdot n}{t\cdot (t-1)} &\text{第一个为AA时} \\\
&+\frac{m\cdot k+0.75m\cdot(m-1)+0.5m\cdot n}{t\cdot (t-1)} &\text{第一个为Aa时}\\
&+\frac{n\cdot (k-1)+n\cdot m+0}{t\cdot(t-1)} &\text{第一个为aa时}
\end{align*}
$$

其中t为*k*+*m*+*n*。

除此之外我们还有一个思路，先计算出后代全为隐性纯合的概率，然后再用1减去此概率即可，即：
$$
Pr(AA\or Aa)=1-\frac{0.5m\cdot n+0.5n\cdot m+m\cdot (m-1)+n\cdot (n-1)}{t\cdot (t-1)}
$$

下面我们用python来解决这个问题：

In [1]:

```python
def firstLaw(k,m,n):
    t = float(k+m+n)
    return 1 - (m*n+m*(m-1)+n*(n-1))/(t*(t-1))
```

In [2]:

```python
print(firstLaw(2,2,2))
```

Out[2]:

```python
0.7833333333333333
```

